<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.system.mapper.StQuotaAttachmentMapper">
    
    <resultMap type="StQuotaAttachment" id="StQuotaAttachmentResult">
        <result property="id"    column="id"    />
        <result property="quotaId"    column="quota_id"    />
        <result property="fileName"    column="file_name"    />
        <result property="fileUrl"    column="file_url"    />
        <result property="fileSize"    column="file_size"    />
        <result property="fileType"    column="file_type"    />
        <result property="mimeType"    column="mime_type"    />
        <result property="uploadBy"    column="upload_by"    />
        <result property="uploadTime"    column="upload_time"    />
        <result property="status"    column="status"    />
        <result property="sortOrder"    column="sort_order"    />
        <result property="memo"    column="memo"    />
        <result property="createBy"    column="create_by"    />
        <result property="createTime"    column="create_time"    />
        <result property="updateBy"    column="update_by"    />
        <result property="updateTime"    column="update_time"    />
    </resultMap>

    <sql id="selectStQuotaAttachmentVo">
        select id, quota_id, file_name, file_url, file_size, file_type, mime_type, 
               upload_by, upload_time, status, sort_order, memo, 
               create_by, create_time, update_by, update_time 
        from st_quota_attachment
    </sql>

    <select id="selectStQuotaAttachmentList" parameterType="StQuotaAttachment" resultMap="StQuotaAttachmentResult">
        <include refid="selectStQuotaAttachmentVo"/>
        <where>  
            <if test="quotaId != null">and quota_id = #{quotaId}</if>
            <if test="fileName != null and fileName != ''">and file_name like concat('%', #{fileName}, '%')</if>
            <if test="fileType != null and fileType != ''">and file_type = #{fileType}</if>
            <if test="uploadBy != null and uploadBy != ''">and upload_by = #{uploadBy}</if>
            <if test="status != null">and status = #{status}</if>
        </where>
        order by sort_order asc, upload_time desc
    </select>
    
    <select id="selectStQuotaAttachmentById" parameterType="Long" resultMap="StQuotaAttachmentResult">
        <include refid="selectStQuotaAttachmentVo"/>
        where id = #{id}
    </select>

    <select id="selectStQuotaAttachmentListByQuotaId" parameterType="Long" resultMap="StQuotaAttachmentResult">
        <include refid="selectStQuotaAttachmentVo"/>
        where quota_id = #{quotaId} and status = 1
        order by sort_order asc, upload_time desc
    </select>
        
    <insert id="insertStQuotaAttachment" parameterType="StQuotaAttachment" useGeneratedKeys="true" keyProperty="id">
        insert into st_quota_attachment
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="quotaId != null">quota_id,</if>
            <if test="fileName != null and fileName != ''">file_name,</if>
            <if test="fileUrl != null and fileUrl != ''">file_url,</if>
            <if test="fileSize != null">file_size,</if>
            <if test="fileType != null">file_type,</if>
            <if test="mimeType != null">mime_type,</if>
            <if test="uploadBy != null">upload_by,</if>
            <if test="uploadTime != null">upload_time,</if>
            <if test="status != null">status,</if>
            <if test="sortOrder != null">sort_order,</if>
            <if test="memo != null">memo,</if>
            <if test="createBy != null">create_by,</if>
            <if test="createTime != null">create_time,</if>
            <if test="updateBy != null">update_by,</if>
            <if test="updateTime != null">update_time,</if>
         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="quotaId != null">#{quotaId},</if>
            <if test="fileName != null and fileName != ''">#{fileName},</if>
            <if test="fileUrl != null and fileUrl != ''">#{fileUrl},</if>
            <if test="fileSize != null">#{fileSize},</if>
            <if test="fileType != null">#{fileType},</if>
            <if test="mimeType != null">#{mimeType},</if>
            <if test="uploadBy != null">#{uploadBy},</if>
            <if test="uploadTime != null">#{uploadTime},</if>
            <if test="status != null">#{status},</if>
            <if test="sortOrder != null">#{sortOrder},</if>
            <if test="memo != null">#{memo},</if>
            <if test="createBy != null">#{createBy},</if>
            <if test="createTime != null">#{createTime},</if>
            <if test="updateBy != null">#{updateBy},</if>
            <if test="updateTime != null">#{updateTime},</if>
         </trim>
    </insert>

    <update id="updateStQuotaAttachment" parameterType="StQuotaAttachment">
        update st_quota_attachment
        <trim prefix="SET" suffixOverrides=",">
            <if test="quotaId != null">quota_id = #{quotaId},</if>
            <if test="fileName != null and fileName != ''">file_name = #{fileName},</if>
            <if test="fileUrl != null and fileUrl != ''">file_url = #{fileUrl},</if>
            <if test="fileSize != null">file_size = #{fileSize},</if>
            <if test="fileType != null">file_type = #{fileType},</if>
            <if test="mimeType != null">mime_type = #{mimeType},</if>
            <if test="uploadBy != null">upload_by = #{uploadBy},</if>
            <if test="uploadTime != null">upload_time = #{uploadTime},</if>
            <if test="status != null">status = #{status},</if>
            <if test="sortOrder != null">sort_order = #{sortOrder},</if>
            <if test="memo != null">memo = #{memo},</if>
            <if test="updateBy != null">update_by = #{updateBy},</if>
            <if test="updateTime != null">update_time = #{updateTime},</if>
        </trim>
        where id = #{id}
    </update>

    <delete id="deleteStQuotaAttachmentById" parameterType="Long">
        update st_quota_attachment set status = 0 where id = #{id}
    </delete>

    <delete id="deleteStQuotaAttachmentByIds" parameterType="String">
        update st_quota_attachment set status = 0 where id in 
        <foreach item="id" collection="array" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>
</mapper>


